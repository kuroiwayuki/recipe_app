<%= form_with model: @recipet, local: true, data: { controller: "nested-form" } do |f| %>
  <div class="space-y-6 bg-white p-6 rounded-lg shadow max-w-3xl mx-auto">
    <!-- 購入日 -->
    <div>
      <%= f.label :purchased_at, "購入日", class: "block text-sm font-semibold text-gray-700 mb-1" %>
      <%= f.date_select :purchased_at, {}, class: "border border-gray-300 rounded px-3 py-2" %>
    </div>

    <!-- 商品リスト -->
    <div data-nested-form-target="items">
      <%= f.fields_for :recipet_items do |ri_fields| %>
        <%= render "recipet_item_fields", f: ri_fields %>
      <% end %>
    </div>

    <!-- 商品追加ボタン -->
    <div>
      <button type="button"
              class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
              data-action="nested-form#add">
        ＋ 商品を追加
      </button>
    </div>

    <%= f.submit "保存", class: "bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 transition" %>
  </div>

  <!-- テンプレート -->
  <template data-nested-form-target="template">
    <%= f.fields_for :recipet_items, RecipetItem.new, child_index: "NEW_RECORD" do |ri_fields| %>
      <%= render "recipet_item_fields", f: ri_fields %>
    <% end %>
  </template>
<% end %>
